{"inputs": {"bug_report": "Ao fazer logout, o token JWT não é invalidado no servidor. Usuário pode continuar usando o token antigo por até 24 horas."}, "outputs": {"reference": "Como o sistema de autenticação, eu quero invalidar tokens JWT imediatamente após logout, para que usuários não possam continuar acessando recursos após sair da aplicação.\n\nCritérios de Aceitação:\n- Dado que um usuário está autenticado\n- Quando ele faz logout\n- Então o token JWT deve ser adicionado a uma blacklist\n- E requisições futuras com esse token devem retornar HTTP 401\n- E o usuário deve ser redirecionado para a tela de login\n\nContexto de Segurança:\n- Bug atual: tokens permanecem válidos após logout\n- Risco: sessões órfãs podem ser exploradas\n- Solução: implementar token blacklist no Redis com TTL"}, "metadata": {"domain": "fintech", "type": "security", "complexity": "medium"}}
{"inputs": {"bug_report": "Upload de foto de perfil falha para imagens maiores que 5MB. Erro: 'Request Entity Too Large'."}, "outputs": {"reference": "Como um usuário personalizando meu perfil, eu quero fazer upload de fotos de alta qualidade, para que minha imagem de perfil tenha boa resolução.\n\nCritérios de Aceitação:\n- Dado que estou fazendo upload de uma foto de perfil\n- Quando seleciono uma imagem de até 10MB\n- Então o sistema deve aceitar o upload\n- E deve comprimir automaticamente se necessário\n- E deve mostrar preview antes de salvar\n\nContexto Técnico:\n- Limite atual: 5MB\n- Limite proposto: 10MB\n- Adicionar compressão automática no frontend"}, "metadata": {"domain": "social_media", "type": "validation", "complexity": "simple"}}
{"inputs": {"bug_report": "Busca de cursos retorna resultados irrelevantes. Pesquisa por 'Python Avançado' mostra cursos de Java e JavaScript."}, "outputs": {"reference": "Como um aluno procurando cursos, eu quero que a busca retorne resultados relevantes, para que eu encontre exatamente o que preciso aprender.\n\nCritérios de Aceitação:\n- Dado que estou na página de busca\n- Quando digito 'Python Avançado'\n- Então devo ver apenas cursos relacionados a Python\n- E cursos avançados devem aparecer primeiro\n- E não deve mostrar cursos de outras linguagens\n\nContexto Técnico:\n- Implementar busca fuzzy com Elasticsearch\n- Adicionar weight para título (3x) e descrição (1x)\n- Filtrar por tags exatas da linguagem"}, "metadata": {"domain": "edtech", "type": "business_logic", "complexity": "medium"}}
{"inputs": {"bug_report": "Notificações push duplicadas. Usuários recebem a mesma notificação 2-3 vezes em sequência."}, "outputs": {"reference": "Como um usuário do app, eu quero receber cada notificação apenas uma vez, para que não seja incomodado com mensagens duplicadas.\n\nCritérios de Aceitação:\n- Dado que o sistema envia uma notificação\n- Quando a notificação é entregue ao dispositivo\n- Então o usuário deve receber apenas uma cópia\n- E notificações duplicadas devem ser filtradas\n- E o sistema deve logar tentativas de duplicação\n\nContexto Técnico:\n- Implementar idempotency key por notificação\n- Cache Redis com TTL de 5 minutos\n- Deduplicate no FCM/APNs sender"}, "metadata": {"domain": "mobile", "type": "integration", "complexity": "medium"}}
{"inputs": {"bug_report": "Botão 'Salvar' permanece desabilitado mesmo após preencher todos os campos obrigatórios do formulário."}, "outputs": {"reference": "Como um usuário preenchendo um formulário, eu quero que o botão 'Salvar' seja habilitado quando todos os campos obrigatórios estiverem preenchidos, para que eu possa concluir a ação.\n\nCritérios de Aceitação:\n- Dado que estou em um formulário com campos obrigatórios\n- Quando preencho todos os campos obrigatórios\n- Então o botão 'Salvar' deve ser habilitado\n- E deve mudar de cor para indicar que está ativo\n- E ao clicar, deve salvar os dados"}, "metadata": {"domain": "saas", "type": "UI/UX", "complexity": "simple"}}
{"inputs": {"bug_report": "Query de relatório mensal causa deadlock no banco de dados durante execução.\n\nDetalhes:\n- Query: SELECT * FROM orders JOIN customers JOIN products WHERE order_date BETWEEN '2025-01-01' AND '2025-01-31'\n- Timeout após 30 segundos\n- Postgres log: 'deadlock detected'\n- Outras transações ficam bloqueadas"}, "outputs": {"reference": "Como um analista de negócios, eu quero gerar relatórios mensais sem impactar outras operações do sistema, para que eu possa analisar dados sem causar lentidão.\n\nCritérios de Aceitação:\n- Dado que solicito um relatório mensal\n- Quando a query é executada\n- Então deve completar em menos de 10 segundos\n- E não deve bloquear outras transações\n- E não deve causar deadlocks\n\nContexto Técnico:\n- Problema: query sem índices, lock em múltiplas tabelas\n- Solução: criar índices compostos em order_date\n- Usar read replica para relatórios\n- Implementar MVCC com isolation level READ COMMITTED"}, "metadata": {"domain": "erp", "type": "performance", "complexity": "medium"}}
{"inputs": {"bug_report": "Vídeo não reproduz em dispositivos iOS 15+. Player mostra tela preta com mensagem 'Formato não suportado'."}, "outputs": {"reference": "Como um usuário de iPhone, eu quero assistir vídeos sem problemas de compatibilidade, para que eu possa consumir conteúdo normalmente.\n\nCritérios de Aceitação:\n- Dado que estou usando iOS 15 ou superior\n- Quando clico em um vídeo para reproduzir\n- Então o vídeo deve iniciar normalmente\n- E deve funcionar em todos os formatos suportados (MP4, HLS)\n- E controles de reprodução devem funcionar\n\nContexto Técnico:\n- Codec atual: H.264 baseline\n- iOS 15+ requer H.264 main/high profile\n- Atualizar encoding no pipeline de upload"}, "metadata": {"domain": "streaming", "type": "integration", "complexity": "simple"}}
{"inputs": {"bug_report": "Cálculo de frete grátis está incorreto para regiões do Nordeste. Sistema aplica frete mesmo em compras acima de R$ 200."}, "outputs": {"reference": "Como um cliente do Nordeste, eu quero receber frete grátis em compras acima de R$ 200, para que eu tenha o mesmo benefício de outras regiões.\n\nCritérios de Aceitação:\n- Dado que sou cliente do Nordeste\n- Quando adiciono produtos totalizando mais de R$ 200 ao carrinho\n- Então o frete deve ser gratuito\n- E deve exibir mensagem 'Frete Grátis aplicado'\n- E o total do pedido não deve incluir custo de frete\n\nContexto Técnico:\n- Bug: regra de frete grátis não está checando CEPs do Nordeste\n- CEPs afetados: 40000-000 a 65999-999\n- Adicionar validação por região no cálculo de frete"}, "metadata": {"domain": "e-commerce", "type": "business_logic", "complexity": "simple"}}
{"inputs": {"bug_report": "Página de checkout demora 15 segundos para carregar. DevTools mostra 47 requisições HTTP sendo feitas."}, "outputs": {"reference": "Como um cliente finalizando compra, eu quero que a página de checkout carregue rapidamente, para que eu possa concluir minha compra sem demora.\n\nCritérios de Aceitação:\n- Dado que estou indo para o checkout\n- Quando a página carrega\n- Então deve completar em menos de 3 segundos\n- E deve fazer no máximo 10 requisições HTTP\n- E imagens devem estar otimizadas\n\nContexto Técnico:\n- Problema: 47 requisições, múltiplas APIs chamadas individualmente\n- Solução: implementar GraphQL para agregar dados\n- Lazy load de scripts não críticos\n- Implementar HTTP/2 server push"}, "metadata": {"domain": "e-commerce", "type": "performance", "complexity": "medium"}}
{"inputs": {"bug_report": "Backup automático diário falha silenciosamente. Último backup bem-sucedido foi há 7 dias, mas sistema não alertou ninguém."}, "outputs": {"reference": "Como administrador do sistema, eu quero ser alertado imediatamente quando backups falharem, para que eu possa tomar ação antes de perder dados críticos.\n\nCritérios de Aceitação:\n- Dado que o backup automático está configurado\n- Quando um backup falha\n- Então devo receber alerta por email e Slack\n- E o sistema deve tentar novamente em 1 hora\n- E após 3 falhas, deve escalar para o time de infra\n\nContexto Técnico:\n- Adicionar monitoring no cron job\n- Implementar dead letter queue para falhas\n- Logs estruturados com severity level ERROR\n- Integração com PagerDuty para alertas críticos"}, "metadata": {"domain": "saas", "type": "integration", "complexity": "medium"}}
{"inputs": {"bug_report": "Usuário consegue deletar consulta médica agendada para daqui a 2 horas sem confirmação. Paciente perde horário e médico fica sem avisar."}, "outputs": {"reference": "Como um paciente gerenciando minhas consultas, eu quero uma confirmação clara antes de cancelar consultas próximas, para que eu não cancele por engano e cause transtornos.\n\nCritérios de Aceitação:\n- Dado que tenho uma consulta agendada para menos de 24 horas\n- Quando tento cancelar\n- Então deve aparecer modal de confirmação\n- E deve alertar sobre a proximidade da consulta\n- E deve informar sobre possível taxa de cancelamento\n- E ao confirmar, deve notificar o médico imediatamente\n\nContexto Técnico:\n- Adicionar validação de tempo até consulta\n- Implementar confirmação em duas etapas\n- Enviar webhook para sistema de notificação médica"}, "metadata": {"domain": "healthtech", "type": "business_logic", "complexity": "medium"}}
{"inputs": {"bug_report": "API rate limit está bloqueando usuários legítimos. Cliente faz 10 requisições em 1 minuto e recebe HTTP 429 'Too Many Requests'."}, "outputs": {"reference": "Como desenvolvedor integrando com a API, eu quero um rate limit justo que permita uso normal, para que minha aplicação não seja bloqueada desnecessariamente.\n\nCritérios de Aceitação:\n- Dado que sou um cliente autenticado da API\n- Quando faço até 100 requisições por minuto\n- Então todas devem ser processadas normalmente\n- E o header 'X-RateLimit-Remaining' deve mostrar saldo\n- E apenas acima de 100/min deve retornar HTTP 429\n\nContexto Técnico:\n- Rate limit atual: 10 req/min (muito baixo)\n- Rate limit proposto: 100 req/min para tier free, 1000 para premium\n- Implementar sliding window no Redis\n- Retornar header Retry-After em 429"}, "metadata": {"domain": "saas", "type": "business_logic", "complexity": "medium"}}
{"inputs": {"bug_report": "Tradução automática está trocando 'salvar' por 'economizar' em todo o sistema. Botões mostram 'Economizar alterações' ao invés de 'Salvar alterações'."}, "outputs": {"reference": "Como um usuário do sistema em português, eu quero ver traduções corretas e naturais, para que eu entenda claramente as ações disponíveis.\n\nCritérios de Aceitação:\n- Dado que estou usando o sistema em português\n- Quando vejo botões de ação\n- Então deve mostrar 'Salvar' ao invés de 'Economizar'\n- E todas as traduções devem fazer sentido no contexto\n- E terminologia deve ser consistente em todo o sistema"}, "metadata": {"domain": "saas", "type": "UI/UX", "complexity": "simple"}}
{"inputs": {"bug_report": "Webhook de rastreamento não retorna HTTP 200 quando processa com sucesso, causando reenvios infinitos do transportador.\n\nDetalhes:\n- POST /api/webhooks/tracking\n- Sistema processa o evento corretamente\n- Mas retorna HTTP 204 ao invés de HTTP 200\n- Transportador interpreta como falha e reenvia\n- 1 evento real → 50+ reenvios"}, "outputs": {"reference": "Como o sistema de logística, eu quero confirmar recebimento de webhooks corretamente, para que transportadores não reenviem eventos já processados.\n\nCritérios de Aceitação:\n- Dado que recebo um webhook de rastreamento\n- Quando processo o evento com sucesso\n- Então devo retornar HTTP 200 com body {\"status\": \"received\"}\n- E o transportador não deve reenviar\n- E eventos duplicados devem ser ignorados via idempotency key\n\nContexto Técnico:\n- Bug: endpoint retorna HTTP 204 (sem body)\n- Transportador espera HTTP 200 (com body)\n- Implementar idempotency check no Redis\n- TTL de 24h para prevenir duplicatas"}, "metadata": {"domain": "logistics", "type": "integration", "complexity": "medium"}}
{"inputs": {"bug_report": "Gráfico de vendas não exibe dados quando filtro contém acentuação. Busca por 'São Paulo' não retorna resultados, mas 'Sao Paulo' funciona."}, "outputs": {"reference": "Como um gestor analisando vendas por região, eu quero que buscas funcionem com acentuação, para que eu possa filtrar dados usando nomes corretos das cidades.\n\nCritérios de Aceitação:\n- Dado que estou filtrando vendas por cidade\n- Quando digito 'São Paulo' com acentuação\n- Então o gráfico deve exibir os dados corretamente\n- E deve funcionar com qualquer acentuação (á, é, í, ó, ú, ã, õ, ç)\n- E resultados devem ser idênticos com ou sem acento\n\nContexto Técnico:\n- Normalizar strings usando Unicode NFD\n- Remover diacríticos na comparação\n- Ou criar coluna computed para busca: LOWER(UNACCENT(cidade))"}, "metadata": {"domain": "crm", "type": "business_logic", "complexity": "medium"}}
{"inputs": {"bug_report": "Sistema de chat ao vivo fica offline após 30 minutos de inatividade. WebSocket desconecta e não reconecta automaticamente."}, "outputs": {"reference": "Como um atendente de suporte, eu quero que o chat permaneça conectado durante meu turno, para que eu não perca mensagens de clientes.\n\nCritérios de Aceitação:\n- Dado que estou logado no sistema de chat\n- Quando fico inativo por mais de 30 minutos\n- Então o WebSocket deve permanecer conectado\n- E deve enviar heartbeat a cada 25 segundos\n- E se desconectar, deve reconectar automaticamente\n\nContexto Técnico:\n- Implementar ping/pong WebSocket a cada 25s\n- Auto-reconnect com exponential backoff (1s, 2s, 4s, 8s)\n- Mostrar indicador visual de status da conexão"}, "metadata": {"domain": "saas", "type": "integration", "complexity": "medium"}}
{"inputs": {"bug_report": "Exportação de dados para LGPD gera arquivo com informações de outros usuários. Cliente ID 123 recebeu dados dos clientes 122, 123, 124 em seu export."}, "outputs": {"reference": "Como um usuário solicitando meus dados pessoais, eu quero receber APENAS minhas informações, para garantir privacidade e conformidade com LGPD.\n\nCritérios de Aceitação:\n- Dado que solicito exportação dos meus dados\n- Quando o arquivo é gerado\n- Então deve conter APENAS meus dados pessoais\n- E não deve incluir informações de outros usuários\n- E deve incluir todos os meus dados (profile, orders, logs)\n\nContexto de Segurança:\n- Severidade: CRÍTICA (vazamento de dados LGPD)\n- Bug: query SQL sem WHERE clause correto\n- Solução: adicionar filtro WHERE user_id = ? em todas as queries\n- Adicionar testes automatizados para prevenir vazamento"}, "metadata": {"domain": "saas", "type": "security", "complexity": "medium"}}
{"inputs": {"bug_report": "Dark mode não aplica em todos os componentes. Formulários e modais permanecem com fundo branco, causando contraste ruim."}, "outputs": {"reference": "Como um usuário que prefere dark mode, eu quero que TODOS os componentes respeitem minha preferência, para que eu tenha uma experiência visual consistente e confortável.\n\nCritérios de Aceitação:\n- Dado que ativo dark mode nas configurações\n- Quando navego por qualquer tela do sistema\n- Então todos os componentes devem usar tema escuro\n- E não deve haver elementos brancos que causem desconforto visual\n- E contraste de texto deve ser suficiente (WCAG AA)\n\nContexto Técnico:\n- Componentes sem dark mode: Modal, Dropdown, DatePicker\n- Implementar CSS variables para tema global\n- Testar em todos os componentes do design system"}, "metadata": {"domain": "saas", "type": "UI/UX", "complexity": "medium"}}
{"inputs": {"bug_report": "Integração com Stripe falha para cartões internacionais. Erro: 'Currency not supported'.\n\nDetalhes:\n- Cartão: Visa USA\n- Moeda: BRL (R$)\n- Status: payment_intent.failed\n- Error code: currency_not_supported\n- Cliente internacional não consegue pagar"}, "outputs": {"reference": "Como um cliente internacional, eu quero poder pagar com meu cartão estrangeiro, para que eu possa comprar produtos mesmo estando fora do Brasil.\n\nCritérios de Aceitação:\n- Dado que estou pagando com cartão internacional\n- Quando finalizo a compra em BRL\n- Então o pagamento deve ser processado com conversão automática\n- E deve exibir o valor convertido para minha moeda\n- E taxa de conversão deve ser transparente\n\nContexto Técnico:\n- Habilitar multiple currencies no Stripe dashboard\n- Adicionar automatic currency conversion\n- Mostrar valor em BRL e moeda do cartão\n- Documentar taxas de conversão para o cliente"}, "metadata": {"domain": "fintech", "type": "integration", "complexity": "medium"}}
{"inputs": {"bug_report": "Aplicação mobile consome 45% da bateria em 2 horas de uso. GPS fica ligado em background mesmo quando não está em uso ativo.\n\nObservações:\n- Battery drain anormal\n- GPS location updates a cada 5 segundos\n- Usuários reclamando de bateria acabando rápido\n- App não deveria usar GPS em background"}, "outputs": {"reference": "Como um usuário do app mobile, eu quero que o aplicativo preserve a bateria do meu dispositivo, para que eu possa usar por mais tempo sem recarregar.\n\nCritérios de Aceitação:\n- Dado que o app está em background\n- Quando não estou usando funcionalidades de localização\n- Então o GPS deve ser desligado automaticamente\n- E consumo de bateria deve ser inferior a 5% por hora\n- E location updates devem ocorrer apenas quando necessário\n\nCritérios Técnicos:\n- Desabilitar GPS quando app vai para background\n- Usar significant location changes ao invés de continuous updates\n- Reduzir precisão quando alta precisão não é necessária\n- Implementar battery optimization no Android\n\nContexto do Bug:\n- Problema: GPS com updates a cada 5s em background\n- Solução: desabilitar GPS em background, habilitar apenas quando tela ativa\n- Battery drain: 45% em 2h → objetivo: < 10% em 2h"}, "metadata": {"domain": "mobile", "type": "performance", "complexity": "medium"}}
{"inputs": {"bug_report": "Plataforma de telemedicina com múltiplas falhas críticas durante consultas remotas.\n\nCONTEXTO:\nPlataforma de saúde digital com 200+ médicos e 50.000 pacientes ativos.\nConsultas por vídeo com prescrição eletrônica integrada.\n\nPROBLEMAS IDENTIFICADOS:\n\n1. SEGURANÇA - Prontuário acessível entre sessões:\n   - Médico A encerra consulta com Paciente X\n   - Médico A inicia consulta com Paciente Y\n   - Prontuário do Paciente X ainda aparece na tela por 10-15 segundos\n   - Médico pode ver dados sensíveis de outro paciente\n   - Violação LGPD e CFM\n\n2. LÓGICA DE NEGÓCIO - Prescrição duplicada de medicamentos:\n   - Paciente tem prescrição ativa de Amoxicilina 500mg\n   - Outro médico prescreve Amoxicilina 500mg novamente\n   - Sistema não alerta sobre duplicidade\n   - Paciente pode tomar dose dobrada\n   - Sem verificação de interação medicamentosa\n\n3. PERFORMANCE - Vídeo degrada com múltiplas consultas simultâneas:\n   - Servidor WebRTC suporta até 50 consultas simultâneas\n   - Acima de 30, qualidade cai para 240p\n   - Áudio com delay de 3-5 segundos\n   - Médicos não conseguem avaliar lesões de pele\n   - 15% das consultas sendo remarcadas por qualidade ruim\n\n4. INTEGRAÇÃO - Cobrança incorreta por tipo de convênio:\n   - Consulta particular: deveria cobrar R$ 250\n   - Convênio A: deveria cobrar R$ 80 (copay)\n   - Convênio B: deveria cobrar R$ 0 (cobertura total)\n   - Sistema cobra R$ 250 para todos\n   - 500+ cobranças incorretas no último mês\n\nIMPACTO:\n- 3 reclamações na ANS (Agência Nacional de Saúde)\n- 200+ pacientes cobrados incorretamente\n- Risco de processo por vazamento de prontuário\n- 15% das teleconsultas remarcadas\n- CFM pode suspender licença da plataforma"}, "outputs": {"reference": "Como um paciente utilizando teleconsulta, eu quero uma plataforma segura, confiável e com cobrança correta, para que eu possa realizar consultas médicas remotas com confiança e privacidade.\n\n=== USER STORY PRINCIPAL ===\n\nTítulo: Plataforma de telemedicina segura, confiável e com cobrança precisa\n\nDescrição:\nComo um paciente da plataforma de telemedicina, eu quero que minhas consultas sejam privadas, que prescrições sejam seguras, que o vídeo tenha qualidade adequada e que a cobrança esteja correta conforme meu convênio, para que eu possa confiar na plataforma para cuidar da minha saúde.\n\n=== CRITÉRIOS DE ACEITAÇÃO ===\n\nA. Segurança - Isolamento de prontuário entre sessões:\n- Dado que um médico encerra uma consulta\n- Quando inicia uma nova consulta com outro paciente\n- Então o prontuário anterior deve ser completamente removido da memória\n- E nenhum dado do paciente anterior deve estar acessível\n- E o sistema deve fazer flush de cache local entre sessões\n- E deve haver log de auditoria de cada acesso a prontuário\n\nB. Lógica de Negócio - Validação de prescrições:\n- Dado que um médico está prescrevendo medicamento\n- Quando o medicamento já está em prescrição ativa do paciente\n- Então o sistema deve alertar sobre duplicidade\n- E deve verificar interações medicamentosas\n- E o médico deve confirmar explicitamente se deseja prosseguir\n- E a justificativa deve ser registrada no prontuário\n\nC. Performance - Qualidade de vídeo estável:\n- Dado que há múltiplas consultas simultâneas\n- Quando o número ultrapassa 30 sessões\n- Então a qualidade mínima deve ser 480p\n- E o delay de áudio deve ser menor que 500ms\n- E deve fazer auto-scaling de servidores WebRTC\n- E deve alertar admin quando capacidade atingir 80%\n\nD. Integração - Cobrança correta por convênio:\n- Dado que um paciente tem convênio cadastrado\n- Quando a consulta é finalizada\n- Então o sistema deve cobrar conforme tabela do convênio\n- E particular: R$ 250, Convênio A: R$ 80, Convênio B: R$ 0\n- E deve emitir nota fiscal com valor correto\n- E divergências devem gerar alerta para o financeiro\n\n=== CRITÉRIOS TÉCNICOS ===\n\nSegurança - Isolamento de Sessão:\n- Implementar session cleanup obrigatório ao encerrar consulta\n- Limpar cache, localStorage e estado do componente\n- Adicionar middleware que valida session_id em cada request\n- Audit log com campos: médico_id, paciente_id, timestamp, ação\n\nPrescrição - Drug Interaction Check:\n- Integrar com base de dados de medicamentos (Anvisa ou similar)\n- Verificar: duplicidade, interação, contraindicação\n- Alertas em 3 níveis: informativo, atenção, bloqueante\n- Manter histórico completo de prescrições por paciente\n\nPerformance - WebRTC Scaling:\n- Migrar para SFU (Selective Forwarding Unit) ao invés de P2P\n- Auto-scaling: adicionar servidor a cada 25 sessões\n- Implementar simulcast para adaptar qualidade ao bandwidth\n- Monitoring: latência, jitter, packet loss por sessão\n\nCobrança - Engine de Regras:\n- Criar tabela de preços por convênio e tipo de consulta\n- Validar convênio do paciente antes de finalizar\n- Implementar reconciliação automática diária\n- Gerar relatório de divergências para auditoria\n\n=== CONTEXTO DO BUG ===\n\nSeveridade: CRÍTICA (Regulatório + Financeiro + Segurança)\n\nImpacto:\n- 3 reclamações ANS\n- 200+ cobranças incorretas\n- Risco de processo LGPD\n- 15% teleconsultas remarcadas\n\nComponentes Afetados:\n- Frontend: sessão de vídeo, tela de prescrição\n- Backend: billing service, prescription service\n- Infraestrutura: WebRTC servers\n- Integrações: convênios, base de medicamentos\n\n=== TASKS TÉCNICAS SUGERIDAS ===\n\nSprint 1 - Hotfix Segurança (3 dias):\n1. [SECURITY] Implementar flush de sessão ao encerrar consulta\n2. [SECURITY] Adicionar audit log de acesso a prontuário\n3. [BILLING] Corrigir cobranças incorretas retroativamente\n\nSprint 2 - Core Fixes (2 semanas):\n4. [BUSINESS] Implementar verificação de prescrição duplicada\n5. [BUSINESS] Integrar base de interação medicamentosa\n6. [BILLING] Criar engine de regras por convênio\n7. [PERF] Migrar WebRTC para SFU com auto-scaling\n\nSprint 3 - Robustez (1 semana):\n8. [MONITOR] Dashboard de qualidade de vídeo\n9. [BILLING] Reconciliação automática diária\n10. [TESTS] Testes de carga para 100 consultas simultâneas"}, "metadata": {"domain": "healthtech", "type": "multiple (security, business_logic, performance, integration)", "complexity": "complex", "severity": "critical"}}
{"inputs": {"bug_report": "Sistema de pagamentos digitais com falhas críticas em transações PIX e conciliação.\n\nCONTEXTO:\nFintech com 100.000+ usuários ativos, processando R$ 5M/dia em transações PIX.\nIntegração com Banco Central via API PIX e múltiplos PSPs (Payment Service Providers).\n\nPROBLEMAS IDENTIFICADOS:\n\n1. CONCORRÊNCIA - Saldo inconsistente em transferências simultâneas:\n   - Conta tem R$ 1.000 de saldo\n   - Transação A: transfere R$ 800 (aprovada)\n   - Transação B: transfere R$ 500 (aprovada - NÃO deveria)\n   - Saldo final: -R$ 300 (conta ficou negativa)\n   - Race condition: ambas leem saldo R$ 1.000 antes de debitar\n   - 47 contas com saldo negativo na última semana\n\n   Logs:\n   ```\n   [10:00:00.100] TX-A: Read balance = R$ 1000.00\n   [10:00:00.105] TX-B: Read balance = R$ 1000.00\n   [10:00:00.200] TX-A: Debit R$ 800.00 → New balance = R$ 200.00\n   [10:00:00.205] TX-B: Debit R$ 500.00 → New balance = R$ 500.00\n   [10:00:00.300] TX-A: COMMIT\n   [10:00:00.305] TX-B: COMMIT (overwrites TX-A balance)\n   ```\n\n2. INTEGRAÇÃO - PIX agendado não executa na data:\n   - Usuário agenda PIX para dia 15\n   - Cron job executa às 00:00 UTC\n   - Servidor está em UTC, usuários em BRT (UTC-3)\n   - PIX executa às 21:00 do dia 14 para o usuário\n   - 3 horas antes do esperado\n   - Alguns PIX falham por saldo insuficiente (salário não caiu ainda)\n\n3. CONCILIAÇÃO - Transações fantasma no extrato:\n   - Banco confirma PIX recebido via webhook\n   - Sistema credita na conta do usuário\n   - Banco envia segundo webhook (retry por timeout)\n   - Sistema credita novamente (duplicata)\n   - Saldo do usuário inflado artificialmente\n   - 23 créditos duplicados totalizando R$ 45.000\n\n4. SEGURANÇA - Token de autenticação PIX reutilizado:\n   - Token de autorização de transação PIX tem validade de 5 minutos\n   - Após expirar, sistema não invalida no cache\n   - Atacante pode capturar e reusar token expirado\n   - Permite autorizar transações sem novo 2FA\n\nIMPACTO:\n- R$ 45.000 em créditos duplicados\n- 47 contas com saldo negativo (R$ 28.000 de exposure)\n- Banco Central pode aplicar multa por não conformidade\n- 3 tentativas de fraude detectadas usando tokens expirados\n- Risco de perda de licença de operação"}, "outputs": {"reference": "Como um usuário da fintech, eu quero que minhas transações PIX sejam processadas de forma segura, precisa e no momento correto, para que eu possa confiar na plataforma para movimentar meu dinheiro.\n\n=== USER STORY PRINCIPAL ===\n\nTítulo: Transações PIX seguras, consistentes e com conciliação confiável\n\nDescrição:\nComo um usuário realizando transações financeiras, eu quero que meu saldo esteja sempre correto, que PIX agendados executem na hora certa, que não haja duplicidade de créditos e que a autenticação seja segura, para que eu possa confiar na plataforma com meu dinheiro.\n\n=== CRITÉRIOS DE ACEITAÇÃO ===\n\nA. Concorrência - Saldo sempre consistente:\n- Dado que tenho R$ 1.000 de saldo\n- Quando duas transferências simultâneas tentam debitar\n- Então apenas a primeira deve ser aprovada se o saldo for insuficiente para ambas\n- E a segunda deve retornar erro \"saldo insuficiente\"\n- E o saldo NUNCA deve ficar negativo\n- E deve usar lock pessimista ou otimista na transação\n\nB. Integração - PIX agendado no horário correto:\n- Dado que agendo um PIX para dia 15\n- Quando chega o dia 15 no fuso horário do usuário (BRT)\n- Então o PIX deve ser executado às 00:00 BRT (03:00 UTC)\n- E deve respeitar o timezone configurado na conta\n- E deve enviar notificação ao executar\n\nC. Conciliação - Sem créditos duplicados:\n- Dado que recebo um PIX via webhook do banco\n- Quando o banco envia retry do mesmo webhook\n- Então o sistema deve detectar a duplicata via idempotency key\n- E deve retornar HTTP 200 sem creditar novamente\n- E deve logar a tentativa de duplicata\n\nD. Segurança - Token PIX com invalidação rigorosa:\n- Dado que autorizo uma transação PIX com 2FA\n- Quando o token expira após 5 minutos\n- Então deve ser invalidado no cache e no banco\n- E tentativas de reuso devem retornar HTTP 401\n- E devem gerar alerta de segurança\n- E a transação deve ser bloqueada\n\n=== CRITÉRIOS TÉCNICOS ===\n\nConcorrência - Controle de Saldo:\n- Implementar SELECT FOR UPDATE na leitura de saldo\n- Ou usar versioning otimista com retry\n- Transação atômica: verificar saldo + debitar em uma operação\n- Adicionar constraint: balance >= 0 no banco de dados\n\nTimezone - PIX Agendado:\n- Armazenar timezone do usuário no perfil\n- Converter scheduled_at para UTC ao salvar\n- Cron job usa UTC internamente, converte para exibição\n- Testes para DST (horário de verão)\n\nIdempotência - Webhook Dedup:\n- Extrair idempotency_key do webhook (end-to-end ID do PIX)\n- Verificar no Redis antes de processar\n- TTL: 48 horas\n- Se já existe, retornar 200 sem processar\n\nSegurança - Token Management:\n- Invalidar token no Redis ao expirar (não apenas verificar TTL)\n- Adicionar token à blacklist após uso único\n- Rate limit: máx 3 tentativas de autorização por minuto\n- Alertas para tentativas com tokens expirados\n\n=== CONTEXTO DO BUG ===\n\nSeveridade: CRÍTICA (Financeiro + Regulatório)\n\nImpacto Financeiro:\n- R$ 45.000 em créditos duplicados\n- R$ 28.000 de exposure em contas negativas\n- Risco de multa do Banco Central\n\nProblemas Técnicos:\n1. Race condition em débito (sem lock)\n2. Timezone UTC vs BRT em cron jobs\n3. Webhook sem idempotência\n4. Cache de token sem invalidação ativa\n\n=== TASKS TÉCNICAS SUGERIDAS ===\n\nSprint 1 - Hotfix Financeiro (2 dias):\n1. [CRITICAL] Adicionar SELECT FOR UPDATE em transferências\n2. [CRITICAL] Implementar idempotency key em webhooks\n3. [CRITICAL] Corrigir saldos negativos manualmente\n\nSprint 2 - Core Fixes (2 semanas):\n4. [SECURITY] Implementar invalidação ativa de tokens\n5. [INTEGRATION] Corrigir timezone em PIX agendado\n6. [DB] Adicionar constraint balance >= 0\n7. [MONITORING] Alertas para saldo negativo e duplicatas\n\nSprint 3 - Robustez (1 semana):\n8. [CONCILIATION] Relatório automático de divergências\n9. [TESTS] Testes de concorrência com 100 transações simultâneas\n10. [COMPLIANCE] Documentação para auditoria do Banco Central"}, "metadata": {"domain": "fintech", "type": "multiple (concurrency, integration, security, business_logic)", "complexity": "complex", "severity": "critical"}}
{"inputs": {"bug_report": "Plataforma de provas online com falhas críticas durante período de avaliações.\n\nCONTEXTO:\nPlataforma EAD com 30.000 alunos, período de provas finais.\n5.000 alunos fazendo prova simultaneamente.\n\nPROBLEMAS IDENTIFICADOS:\n\n1. SINCRONIZAÇÃO - Timer dessincronizado entre cliente e servidor:\n   - Prova tem duração de 2 horas\n   - Timer no frontend: JavaScript setInterval(1000)\n   - Após 1h, diferença acumulada de 3-5 minutos\n   - Alguns alunos ganham tempo extra, outros perdem\n   - Timer pausa quando aba fica em background (Page Visibility API)\n   - Aluno minimiza aba → timer para → ganha tempo extra\n\n   Logs:\n   ```\n   [CLIENT] Timer: 01:58:30 remaining\n   [SERVER] Timer: 01:55:12 remaining\n   [DRIFT] 3 minutes 18 seconds difference\n   ```\n\n2. PERSISTÊNCIA - Auto-save perde respostas de alunos:\n   - Auto-save dispara a cada 60 segundos\n   - Se conexão cai durante save, respostas pendentes são perdidas\n   - Aluno responde 15 questões, conexão cai, volta com 10 respostas\n   - LocalStorage não é usado como fallback\n   - 89 alunos perderam respostas na última prova\n\n3. CÁLCULO - Nota final incorreta com questões de pesos diferentes:\n   - Prova com 3 seções:\n     * Seção A: 10 questões × 1 ponto = 10 pontos\n     * Seção B: 5 questões × 2 pontos = 10 pontos\n     * Seção C: 2 questões × 5 pontos = 10 pontos\n   - Total esperado: 30 pontos\n   - Sistema calcula: (acertos / total_questões) × 10\n   - Ignora os pesos diferentes\n   - Aluno acerta todas de A e B (15/17 questões) = nota 8.8\n   - Nota correta considerando pesos: (10+10)/30 × 10 = 6.67\n\n4. ACESSIBILIDADE - Prova inacessível para alunos com deficiência visual:\n   - Leitor de tela não identifica as alternativas das questões\n   - Botões sem labels acessíveis\n   - Contraste insuficiente (ratio 2.5:1, mínimo WCAG: 4.5:1)\n   - Timer não é anunciado para leitores de tela\n   - 12 alunos PCD não conseguiram realizar a prova\n\nIMPACTO:\n- 89 alunos perderam respostas (pedidos de recurso)\n- 500+ notas calculadas incorretamente\n- 12 alunos PCD impedidos de fazer prova (risco jurídico - Lei Brasileira de Inclusão)\n- MEC pode abrir processo contra a instituição\n- Timer injusto afetou resultado de 2.000+ alunos"}, "outputs": {"reference": "Como um aluno realizando prova online, eu quero uma plataforma justa, confiável e acessível, para que eu possa demonstrar meu conhecimento sem problemas técnicos.\n\n=== USER STORY PRINCIPAL ===\n\nTítulo: Plataforma de provas online justa, confiável e acessível\n\nDescrição:\nComo um aluno fazendo prova online, eu quero que o timer seja preciso, que minhas respostas sejam salvas de forma segura, que minha nota seja calculada corretamente e que a prova seja acessível independente de deficiência, para que eu tenha uma avaliação justa e igualitária.\n\n=== CRITÉRIOS DE ACEITAÇÃO ===\n\nA. Sincronização - Timer preciso e justo:\n- Dado que inicio uma prova de 2 horas\n- Quando o tempo está passando\n- Então o timer deve estar sincronizado com o servidor (drift máximo: 5 segundos)\n- E o timer NÃO deve pausar quando a aba está em background\n- E a cada 30 segundos deve sincronizar com o servidor\n- E ao expirar, deve submeter automaticamente as respostas salvas\n\nB. Persistência - Respostas nunca são perdidas:\n- Dado que estou respondendo questões\n- Quando a conexão com internet cai\n- Então minhas respostas devem ser salvas localmente (LocalStorage + IndexedDB)\n- E ao reconectar, deve sincronizar com o servidor\n- E deve mostrar indicador de \"salvo\" vs \"pendente de sincronização\"\n- E auto-save deve ocorrer a cada resposta (não apenas por intervalo)\n\nC. Cálculo - Nota correta com pesos:\n- Dado que uma prova tem questões com pesos diferentes\n- Quando minha prova é corrigida\n- Então a nota deve considerar o peso de cada questão\n- E a fórmula deve ser: (soma dos pontos obtidos / soma dos pontos possíveis) × 10\n- E deve exibir detalhamento por seção\n- E deve manter log de cálculo para auditoria\n\nD. Acessibilidade - Prova inclusiva para PCD:\n- Dado que sou um aluno com deficiência visual\n- Quando acesso a prova com leitor de tela\n- Então todas as questões e alternativas devem ter aria-labels\n- E o contraste deve atender WCAG AA (mínimo 4.5:1)\n- E o timer deve ser anunciado periodicamente\n- E deve ser possível navegar apenas com teclado\n- E deve oferecer tempo adicional configurável (50% extra para PCD)\n\n=== CRITÉRIOS TÉCNICOS ===\n\nTimer - Sincronização Server-Side:\n- Timer autoritativo no servidor (source of truth)\n- Cliente faz sync a cada 30 segundos: GET /api/exam/{id}/remaining-time\n- Usar NTP-like correction para compensar latência\n- Ignorar Page Visibility API para timer (usar Web Workers)\n- Server-side: exam_end_time = start_time + duration\n\nPersistência - Offline-First:\n- Salvar cada resposta imediatamente no IndexedDB\n- Queue de sincronização com retry exponential backoff\n- Indicador visual: verde (sincronizado), amarelo (pendente), vermelho (falhou)\n- Ao submeter prova: verificar se todas respostas locais foram sincronizadas\n- Conflito: sempre preferir resposta mais recente (timestamp)\n\nCálculo de Nota - Engine Corrigido:\n```\nnota = (Σ peso_questão × acertou) / (Σ peso_questão) × 10\n\nExemplo:\nSeção A: 8/10 acertos × peso 1 = 8 pontos de 10\nSeção B: 4/5 acertos × peso 2 = 8 pontos de 10\nSeção C: 1/2 acertos × peso 5 = 5 pontos de 10\nTotal: 21/30 pontos = nota 7.0\n```\n\nAcessibilidade - WCAG 2.1 AA:\n- Adicionar role=\"radiogroup\" em alternativas\n- aria-label em todos os botões e controles\n- Contraste mínimo 4.5:1 (usar ferramenta de validação)\n- Timer: aria-live=\"polite\" com anúncio a cada 15 minutos\n- Suporte completo a navegação por teclado (Tab, Enter, Space)\n- Tempo adicional PCD: configurável por aluno no admin\n\n=== CONTEXTO DO BUG ===\n\nSeveridade: CRÍTICA (Jurídico + Acadêmico)\n\nImpacto:\n- 89 alunos perderam respostas\n- 500+ notas incorretas\n- 12 alunos PCD impedidos (Lei Brasileira de Inclusão)\n- Risco de processo do MEC\n- 2.000+ alunos com timer injusto\n\nComponentes Afetados:\n- Frontend: timer, auto-save, acessibilidade\n- Backend: cálculo de notas, sync API\n- Infraestrutura: WebSocket para sync em tempo real\n\n=== TASKS TÉCNICAS SUGERIDAS ===\n\nSprint 1 - Hotfix Urgente (3 dias):\n1. [CALC] Corrigir fórmula de cálculo com pesos\n2. [CALC] Recalcular 500+ notas afetadas\n3. [SAVE] Adicionar LocalStorage como fallback de auto-save\n\nSprint 2 - Core Fixes (2 semanas):\n4. [TIMER] Implementar timer server-side com sync periódico\n5. [TIMER] Usar Web Worker para timer não pausar em background\n6. [SAVE] Migrar para IndexedDB com sync queue\n7. [A11Y] Adicionar aria-labels e roles em questões\n8. [A11Y] Corrigir contraste para WCAG AA\n\nSprint 3 - Robustez (1 semana):\n9. [A11Y] Tempo adicional configurável para PCD\n10. [TIMER] Anúncio de timer para leitores de tela\n11. [TESTS] Testes de carga com 5.000 alunos simultâneos\n12. [AUDIT] Log de cálculo de notas para recursos"}, "metadata": {"domain": "edtech", "type": "multiple (sync, business_logic, accessibility, persistence)", "complexity": "complex", "severity": "critical"}}
